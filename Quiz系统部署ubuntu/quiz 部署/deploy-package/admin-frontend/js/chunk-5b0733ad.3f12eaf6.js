(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b0733ad"],{1511:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-container"},[e._m(0),t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"请输入用户名关键词"},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.searchUsers}},[e._v("搜索")]),t("el-button",{attrs:{type:"success"},on:{click:e.openAddDialog}},[e._v("添加用户")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userList}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),t("el-table-column",{attrs:{label:"用户类型"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:1===s.row.userRole?"danger":"info"}},[e._v(" "+e._s(1===s.row.userRole?"管理员":"普通用户")+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.openEditDialog(s.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",disabled:1===s.row.userRole},on:{click:function(t){return e.resetUserPassword(s.row)}}},[e._v("重置密码")]),t("el-button",{attrs:{size:"mini",type:"danger",disabled:1===s.row.userRole},on:{click:function(t){return e.confirmDelete(s.row)}}},[e._v("删除用户")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pagination.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.pagination,"currentPage",t)}}})],1),t("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"checkpassword"}},[t("el-input",{attrs:{type:"password",placeholder:"请确认密码"},model:{value:e.addForm.checkpassword,callback:function(t){e.$set(e.addForm,"checkpassword",t)},expression:"addForm.checkpassword"}})],1),t("el-form-item",{attrs:{label:"用户类型",prop:"userrole"}},[t("el-select",{attrs:{placeholder:"请选择用户类型"},model:{value:e.addForm.userrole,callback:function(t){e.$set(e.addForm,"userrole",t)},expression:"addForm.userrole"}},[t("el-option",{attrs:{label:"普通用户",value:"0"}}),t("el-option",{attrs:{label:"管理员",value:"1"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:e.addUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑用户",visible:e.editDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.editForm.userName,callback:function(t){e.$set(e.editForm,"userName",t)},expression:"editForm.userName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"留空则不修改密码"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.editLoading},on:{click:e.saveEditUser}},[e._v("保 存")])],1)],1)],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h2",[e._v("用户管理")])])}],i={name:"User",data(){const e=(e,t,s)=>{t!==this.addForm.password?s(new Error("两次输入的密码不一致")):s()};return{userList:[],loading:!1,pagination:{currentPage:1,pageSize:5,total:0},searchForm:{keyword:""},addDialogVisible:!1,addLoading:!1,addForm:{username:"",password:"",checkpassword:"",userrole:"0"},addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],checkpassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:e,trigger:"blur"}],userrole:[{required:!0,message:"请选择用户类型",trigger:"change"}]},editDialogVisible:!1,editLoading:!1,editForm:{id:null,userName:"",password:""},editFormRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}}},created(){this.fetchUserList()},methods:{fetchUserList(){this.loading=!0;const e={page:this.pagination.currentPage,pageSize:this.pagination.pageSize,keyword:this.searchForm.keyword};this.$axios.get("/user/list",{params:e}).then(e=>{const t=e.data;1===t.code?(this.userList=t.data.records||t.data.list||t.data,this.pagination.total=t.data.total||this.userList.length):this.$message.error(t.msg||"获取用户列表失败"),this.loading=!1}).catch(e=>{console.error(e),this.$message.error("获取用户列表失败"),this.loading=!1})},searchUsers(){this.pagination.currentPage=1,this.fetchUserList()},handleSizeChange(e){this.pagination.pageSize=e,this.fetchUserList()},handleCurrentChange(e){this.pagination.currentPage=e,this.fetchUserList()},openAddDialog(){this.addForm={username:"",password:"",checkpassword:"",userrole:"0"},this.addDialogVisible=!0,this.$refs.addForm&&this.$refs.addForm.clearValidate()},addUser(){this.$refs.addForm.validate(e=>{e&&(this.addLoading=!0,this.$axios.post("/addUser",this.addForm).then(e=>{const t=e.data;1===t.code?(this.$message.success("添加用户成功"),this.addDialogVisible=!1,this.fetchUserList()):this.$message.error(t.msg||"添加用户失败"),this.addLoading=!1}).catch(e=>{console.error(e),this.$message.error("添加用户失败"),this.addLoading=!1}))})},resetUserPassword(e){this.$confirm("确定要重置该用户的密码吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post("/user/resetPassword",{id:e.id}).then(e=>{const t=e.data;1===t.code?this.$message.success("密码重置成功，新密码为: 123456"):this.$message.error(t.msg||"密码重置失败")}).catch(e=>{console.error(e),this.$message.error("密码重置失败")})}).catch(()=>{})},confirmDelete(e){this.$confirm("确定要删除该用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.deleteUser(e.id)}).catch(()=>{})},deleteUser(e){this.$axios.delete("/user/delete/"+e).then(e=>{const t=e.data;1===t.code?(this.$message.success("删除用户成功"),this.fetchUserList()):this.$message.error(t.msg||"删除用户失败")}).catch(e=>{console.error(e),this.$message.error("删除用户失败")})},openEditDialog(e){this.editForm={id:e.id,userName:e.userName,password:""},this.editDialogVisible=!0,this.$refs.editForm&&this.$nextTick(()=>{this.$refs.editForm.clearValidate()})},saveEditUser(){this.$refs.editForm.validate(e=>{e&&(this.editLoading=!0,this.$axios.post("/user/update",this.editForm).then(e=>{const t=e.data;1===t.code?(this.$message.success("用户更新成功"),this.editDialogVisible=!1,this.fetchUserList()):this.$message.error(t.msg||"用户更新失败"),this.editLoading=!1}).catch(e=>{console.error(e),this.$message.error("用户更新失败"),this.editLoading=!1}))})}}},o=i,l=(s("a67b"),s("2877")),d=Object(l["a"])(o,r,a,!1,null,"326aab50",null);t["default"]=d.exports},"955a":function(e,t,s){},a67b:function(e,t,s){"use strict";s("955a")}}]);
//# sourceMappingURL=chunk-5b0733ad.3f12eaf6.js.map